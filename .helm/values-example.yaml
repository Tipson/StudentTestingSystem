# Пример конфигурации для StudentTestingSystem
# Скопируй этот файл в values.yaml и измени значения под свою инфраструктуру

# Общие настройки домена
domain:
  base: "lmscloud.ru"  # Базовый домен
  
# Assessment API
assessmentApi:
  environment: "Staging"  # или "Production"
  replicaCount: 2
  service:
    name: "assessment-api"
    portHttp: 8080
  ingress:
    enabled: true
    host: assessment.lmscloud.ru  # Поддомен для Assessment API
  auth:
    issuer: "https://keycloak.lmscloud.ru/realms/lms"  # URL Keycloak
    clientId: "assessment-api"
  database:
    host: "postgres-postgresql.lms.svc.cluster.local"  # Хост PostgreSQL
    port: "5432"
    name: "assessment"  # Имя БД
  redis:
    host: "redis-master.lms.svc.cluster.local"  # Хост Redis
    port: "6379"
  rabbitmq:
    host: "rabbitmq.lms.svc.cluster.local"  # Хост RabbitMQ
  grading:
    useMessageBus: "true"
    serviceUrl: "http://grading-api:8080"
  limits:
    memoryRequests: "256Mi"
    memoryLimits: "512Mi"
    cpuRequests: "100m"
    cpuLimits: "500m"
  gemini:
    baseUrl: "https://gemini-proxy.tipson-510.workers.dev/"  # URL прокси для Gemini
    model: "gemini-2.5-flash"
    temperature: "0.3"
    maxOutputTokens: "2048"

# Media API
mediaApi:
  environment: "Staging"
  replicaCount: 1
  service:
    name: "media-api"
    portHttp: 8080
  ingress:
    enabled: true
    host: media.lmscloud.ru
  auth:
    issuer: "https://keycloak.lmscloud.ru/realms/lms"
    clientId: "media-api"
  database:
    host: "postgres-postgresql.lms.svc.cluster.local"
    port: "5432"
    name: "media"
  s3:
    serviceUrl: "s3.lmscloud.ru"  # URL MinIO
    port: "80"
    defaultBucketName: "assessment"
    withSsl: false  # true если используешь HTTPS для S3
  redis:
    host: "redis-master.lms.svc.cluster.local"
    port: "6379"
  limits:
    memoryRequests: "256Mi"
    memoryLimits: "512Mi"
    cpuRequests: "100m"
    cpuLimits: "500m"

# Identity API
identityApi:
  environment: "Staging"
  replicaCount: 2
  service:
    name: "identity-api"
    portHttp: 8080
  ingress:
    enabled: true
    host: identity.lmscloud.ru
  auth:
    issuer: "https://keycloak.lmscloud.ru/realms/lms"
    clientId: "identity-api"
  database:
    host: "postgres-postgresql.lms.svc.cluster.local"
    port: "5432"
    name: "identity"
  redis:
    host: "redis-master.lms.svc.cluster.local"
    port: "6379"
  limits:
    memoryRequests: "256Mi"
    memoryLimits: "512Mi"
    cpuRequests: "100m"
    cpuLimits: "500m"

# Grading API
gradingApi:
  environment: "Production"
  replicaCount: 2
  service:
    name: "grading-api"
    portHttp: 8080
  auth:
    issuer: "https://keycloak.lmscloud.ru/realms/lms"
  rabbitmq:
    host: "rabbitmq.lms.svc.cluster.local"
  limits:
    memoryRequests: "512Mi"
    memoryLimits: "1Gi"
    cpuRequests: "200m"
    cpuLimits: "1000m"
  gemini:
    baseUrl: "https://gemini-proxy.tipson-510.workers.dev/"
    model: "gemini-2.5-flash"
    temperature: "0.3"
    maxOutputTokens: "2048"

# Frontend
frontend:
  environment: "Staging"
  replicaCount: 2
  service:
    name: "frontend"
    portHttp: 3000
  ingress:
    enabled: true
    host: lmscloud.ru  # Корневой домен для фронтенда
  api:
    assessmentUrl: "https://assessment.lmscloud.ru"
    mediaUrl: "https://media.lmscloud.ru"
    identityUrl: "https://identity.lmscloud.ru"
  keycloak:
    url: "https://keycloak.lmscloud.ru"
    realm: "lms"
    clientId: "swagger"
    redirectPath: "/swagger/oauth2-redirect.html"
    scope: "openid profile email"
    refreshIntervalMs: "60000"
    refreshLeewayMs: "120000"
  limits:
    memoryRequests: "128Mi"
    memoryLimits: "256Mi"
    cpuRequests: "50m"
    cpuLimits: "200m"
